(function(){function r(){axios.get("/site-settings").then(function(n){pKeys=n.data;e()})}function u(){axios.get(`/api/portals/my-team-members`).then(function(n){f(n.data)}).catch(showResponseError)}function f(n){$("#tbl-team-members").bootstrapTable("destroy");$("#tbl-team-members").bootstrapTable({cache:!1,sortable:!0,columns:[{title:"Actions",align:"center",formatter:function(){return`<a class="btn btn-primary btn-sm view"  title="View Details">
                              <i class="fa fa-eye" aria-hidden="true"></i> 
                            </a>
                            <a class="btn btn-primary btn-sm send"  title="Send Message">
                              <i class="fa fa-paper-plane" aria-hidden="true"></i> 
                            </a>`},events:{"click .view":function(n,i,r){n.preventDefault();t(r.id)},"click .send":function(n,t,r){n.preventDefault();i(r)}}},{sortable:!0,field:"name",title:"Name"},{sortable:!0,field:"title",title:"Title"},{sortable:!0,field:"companyName",title:"Company"}],data:n,onDblClickRow:function(n){t(n.teamMemberId)}})}function t(n){axios.get(`/api/portals/participant/${n}`).then(function(n){setFormData($("#participant-form"),n.data);var t=n.data.photoUrl?n.data.photoUrl:"https://via.placeholder.com/150";$("#photoUrl").attr("src","https://via.placeholder.com/150");$("#participant-modal").modal("show")}).catch(showResponseError)}function i(){bootbox.prompt({size:"small",title:"Type your message here.",inputType:"textarea",buttons:{confirm:{label:"Send Message",className:"btn-success"},cancel:{label:"Cancel",className:"btn-danger"}},callback:function(t){if(t){var i={text:t,publisher:n};o(i)}}})}function e(){pubnub=new PubNub({publishKey:pKeys.publishKey,subscribeKey:pKeys.subscribeKey,uuid:n});pubnub.addListener({status:function(n){n.category==="PNConnectedCategory"},message:function(n){var t,i;if(endTimeToken||(localStorage.setItem("endTimeToken",n.timetoken),endTimeToken=n.timetoken),n.publisher!==pubnubUser.uuId)if(t=findUser(n.publisher),t){if(n.message.subscriber&&pubnubUser.uuId!==n.message.subscriber)return;i=renderReceivedMsg(n);updateChatbox(i)}else pubnubUser.channels.push({name:n.channel}),getPublisherAndRenderMessage(n)},presence:function(n){var t=n.occupancy},membership:function(){},user:function(){}})}function o(n){var t={channel:"hello-world",message:n};pubnub.publish(t,function(n,t){console.log(n,t);toastr.success("Message sent.")})}var n;$(function(){u();n=$("#uuid").val();r();$("#btn-send-message").click(i)})})();